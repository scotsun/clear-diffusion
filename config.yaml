# CLEAR VAE Training Configuration

# ============================================
# Device & Seed
# ============================================

device: mps
seed: 42

# ============================================
# Dataset Configuration
# ============================================

dataset:
  name: mnist
  root: ~/datasets/mnist
  split_sizes: [40000, 10000, 10000] 
  input_shape: [3, 32, 32]
  output_shape: [3, 32, 32]
  dtype: float32
  generator:
    corruptions:
      - name: rgb_change
        params:
          color: red
        probability: 0.2
      
      - name: rgb_change
        params:
          color: green
        probability: 0.2
      
      - name: rgb_change
        params:
          color: blue
        probability: 0.2
      
      - name: rgb_change
        params:
          color: yellow
        probability: 0.2
      
      - name: rgb_change
        params:
          color: magenta
        probability: 0.2



  train_loader:
    batch_size: 128
    shuffle: true
    num_workers: 0
    pin_memory: false  
    drop_last: true
  
  valid_loader:
    batch_size: 256
    shuffle: false
    num_workers: 0
    pin_memory: false
    drop_last: false
  
  test_loader:
    batch_size: 128
    shuffle: false
    num_workers: 0
    pin_memory: false
    drop_last: false
# CLEAR VAE Training Configuration
# Generated from Python config dict

# ============================================
# Hyperparameters
# ============================================
hyperparameters:
  lr: 0.0005              # Learning rate
  optimizer: Adam
  batch_size: 128
  beta: 0.2               # KL loss weight (1/5)
  gamma_1: 2000           # Content contrastive loss weight
  gamma_2: 2000           # Style pseudo-supervision loss weight

# ============================================
# VAE Architecture
# ============================================
vae_architecture:
  channels: 32
  channel_multipliers: [1, 2, 4]
  n_resnet_blocks: 1
  x_channels: 3           # Input channels (RGB)
  z_channels: 15          # Total latent dimension
  channel_split: [3, 12]  # [content_dim, style_dim]
  norm_channels: 32
  n_heads: 4              # Attention heads

# ============================================
# Contrastive Learning Module
# ============================================
contrastive_module:
  contrastive_method: SNN
  temperature: [0.2, 0.2]   # [content_temp, style_temp]
  learnable_temp: true
  pool: gap                 # Global average pooling
  use_proj: true            # Use projection head
  use_dense: false          # Dense contrastive disabled

# ============================================
# Trainer Configuration
# ============================================
trainer:
  type: CLEAR_VAEFirstStageTrainer
  num_epochs: 1
  early_stopping:
    patience: 8
    monitor: val_rec_loss
  verbose_period: 2
  weight_init: silu_xavier_init

# ============================================
# Data Configuration
# ============================================
data:
  input_shape: [1, 32, 32]
  output_shape: [1, 32, 32]
  dtype: float32

# ============================================
# MLflow Configuration
# ============================================

mlflow:
  experiment_name: CLEAR_VAE_StyledMNIST
  run_name: null  
  tracking_uri: ./mlruns
  log_every_n_steps: 10

# ============================================
# Visualization Configuration
# ============================================

tsne:
  style_labels: ['red', 'green', 'blue', 'yellow', 'magenta']
  content_labels: ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9']

image_path: outputs/images
